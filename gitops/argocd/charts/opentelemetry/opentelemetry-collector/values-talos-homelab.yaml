# SPDX-FileCopyrightText: Copyright (C) Nicolas Lamirault <nicolas.lamirault@gmail.com>
# SPDX-License-Identifier: Apache-2.0

---

opentelemetry-logs:
  extraEnvs:
  - name: OTEL_RESOURCE_ATTRIBUTES
    value: "k8s.pod.ip=$(MY_POD_IP)"
  - name: K8S_NAMESPACE
    valueFrom:
      fieldRef:
        apiVersion: v1
        fieldPath: metadata.namespace
  - name: K8S_NODE_NAME
    valueFrom:
      fieldRef:
        fieldPath: spec.nodeName
  # - name: K8S_CLUSTER_NAME
  #   value: "portefaix-talos-homelab"
  # - name: K8S_ENVIRONMENT_NAME
  #   value: "homelab"
  # - name: OTEL_RESOURCE_ATTRIBUTES
  #   value: "k8s.cluster.name=$(K8S_CLUSTER_NAME),\
  #     k8s.pod.ip=$(KUBE_POD_IP),\
  #     k8s.node.name=$(K8S_NODE_NAME),\
  #     deployment.environment.name=$(K8S_ENVIRONMENT_NAME)"
  resources:
    limits:
      # cpu: 500m
      memory: 500Mi
    requests:
      cpu: 100m
      memory: 200Mi

opentelemetry-metrics:
  extraEnvs:
  - name: OTEL_RESOURCE_ATTRIBUTES
    value: "k8s.pod.ip=$(MY_POD_IP)"
  - name: K8S_NAMESPACE
    valueFrom:
      fieldRef:
        apiVersion: v1
        fieldPath: metadata.namespace
  - name: K8S_NODE_NAME
    valueFrom:
      fieldRef:
        fieldPath: spec.nodeName
  # - name: K8S_CLUSTER_NAME
  #   value: "portefaix-talos-homelab"
  # - name: K8S_ENVIRONMENT_NAME
  #   value: "homelab"
  resources:
    limits:
      # cpu: 500m
      memory: 500Mi
    requests:
      cpu: 50m
      memory: 100Mi

opentelemetry-metrics-cluster:
  extraEnvs:
  - name: OTEL_RESOURCE_ATTRIBUTES
    value: "k8s.pod.ip=$(MY_POD_IP)"
  - name: K8S_NAMESPACE
    valueFrom:
      fieldRef:
        apiVersion: v1
        fieldPath: metadata.namespace
  - name: K8S_NODE_NAME
    valueFrom:
      fieldRef:
        fieldPath: spec.nodeName
  # - name: K8S_CLUSTER_NAME
  #   value: "portefaix-talos-homelab"
  # - name: K8S_ENVIRONMENT_NAME
  #   value: "homelab"
  resources:
    limits:
      # cpu: 500m
      memory: 500Mi
    requests:
      cpu: 20m
      memory: 100Mi

opentelemetry-traces:
  extraEnvs:
  - name: OTEL_RESOURCE_ATTRIBUTES
    value: "k8s.pod.ip=$(MY_POD_IP)"
  - name: K8S_NAMESPACE
    valueFrom:
      fieldRef:
        apiVersion: v1
        fieldPath: metadata.namespace
  - name: K8S_NODE_NAME
    valueFrom:
      fieldRef:
        fieldPath: spec.nodeName
  # - name: K8S_CLUSTER_NAME
  #   value: "portefaix-talos-homelab"
  # - name: K8S_ENVIRONMENT_NAME
  #   value: "homelab"
  resources:
    limits:
      # cpu: 500m
      memory: 500Mi
    requests:
      cpu: 20m
      memory: 100Mi

opentelemetry-gateway:
  extraEnvs:
  - name: OTEL_RESOURCE_ATTRIBUTES
    value: "k8s.pod.ip=$(MY_POD_IP)"
  - name: K8S_NAMESPACE
    valueFrom:
      fieldRef:
        apiVersion: v1
        fieldPath: metadata.namespace
  - name: K8S_NODE_NAME
    valueFrom:
      fieldRef:
        fieldPath: spec.nodeName
  - name: K8S_CLUSTER_NAME
    value: "portefaix-talos-homelab"
  - name: K8S_ENVIRONMENT_NAME
    value: "homelab"
  resources:
    limits:
      # cpu: 500m
      memory: 500Mi
    requests:
      cpu: 100m
      memory: 200Mi

opentelemetry-ai:
  extraEnvs:
  - name: OTEL_RESOURCE_ATTRIBUTES
    value: "k8s.pod.ip=$(MY_POD_IP)"
  - name: K8S_NAMESPACE
    valueFrom:
      fieldRef:
        apiVersion: v1
        fieldPath: metadata.namespace
  - name: K8S_NODE_NAME
    valueFrom:
      fieldRef:
        fieldPath: spec.nodeName
  # - name: K8S_CLUSTER_NAME
  #   value: "portefaix-talos-homelab"
  # - name: K8S_ENVIRONMENT_NAME
  #   value: "homelab"
  resources:
    limits:
      # cpu: 500m
      memory: 500Mi
    requests:
      cpu: 20m
      memory: 100Mi
