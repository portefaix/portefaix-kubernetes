---
apiVersion: kagent.dev/v1alpha1
kind: MCPServer
metadata:
  labels:
    {{- include "kagent.labels" (index .Subcharts "kagent") | nindent 4 }}
    kagent.dev/discovery: disabled
  name: github-mcp-server
  namespace: {{ .Release.Namespace }}
spec:
  deployment:
    args:
    - 'stdio'
    cmd: "/server/github-mcp-server"
    image: {{ .Values.mcpservers.github.image }}
    port: 3000
    env:
      GITHUB_TOOLSETS: "repos,issues,pull_requests,actions,code_security,experiments"
    secretRefs:
    - name: kagent-github-mcp-credentials
  stdioTransport: {}
  transportType: stdio
