# SPDX-FileCopyrightText: Copyright (C) Nicolas Lamirault <nicolas.lamirault@gmail.com>
# SPDX-License-Identifier: Apache-2.0
---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  {{- if .Values.additionalAnnotations }}
  annotations:
  {{ toYaml .Values.additionalAnnotations | indent 4 }}
  {{- end }}
  labels:
    {{- include "kagent.labels" (index .Subcharts "kagent") | nindent 4 }}
  name: kagent-github-mcp-credentials
  namespace: {{ .Release.Namespace }}
spec:
  refreshInterval: 1h
  secretStoreRef:
    kind: ClusterSecretStore
    name: akeyless
  target:
    name: kagent-github-credentials
    creationPolicy: Owner
  data:
    - secretKey: GITHUB_PERSONAL_ACCESS_TOKEN
      remoteRef:
        conversionStrategy: Default
        decodingStrategy: None
        key: KAGENT_GITHUB_PAT


# apiVersion: v1
# stringData:
#   GITHUB_PERSONAL_ACCESS_TOKEN: $GITHUB_PERSONAL_ACCESS_TOKEN
#   GITHUB_TOOLSETS: "repos,issues,pull_requests,actions,code_security,experiments"
# kind: Secret
# metadata:
#   name: github-mcp-secret
#   namespace: kagent
# type: Opaque
