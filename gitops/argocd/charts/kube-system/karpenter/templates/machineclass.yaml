{{- if .Values.aws.enabled }}
{{- range .Values.machineClasses }}
---
apiVersion: karpenter.azure.com/v1beta1
kind: AzureMachineClass
metadata:
  labels:
    {{- include "karpenter.labels" (index $.Subcharts "karpenter") | nindent 4 }}
  name: {{ .name }}
  namespace: {{ $.Release.namespace }}
spec:
  subscriptionID: {{ .subscriptionId }}
  resourceGroup: {{ .resourceGroup }}
  vmSize: {{ .vmSize }}
  image:
    offer: {{ .image.offer }}
    publisher: {{ .image.publisher }}
    sku: {{ .image.sku }}
    version: {{ .image.version }}
  networkInterfaces:
    - subnetID: {{ .subnetId }}
      securityGroupID: {{ .securityGroupId }}
  osDisk:
    sizeGB: {{ .osDisk.sizeGB }}
    type: {{ .osDisk.type }}
{{- end }}
{{- end }}
